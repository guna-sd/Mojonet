import torch
from torch import Tensor
import time
import numpy as np

def benchmark_matmul(tensor1, tensor2, func, num_iterations=10):
    start_time = time.time()
    for _ in range(num_iterations):
        result = func(tensor1, tensor2)
    end_time = time.time()
    return end_time - start_time

# b = 3
# m = 1024
# n = 2048
# p = 1024

# a = torch.rand(b, m, n).type(torch.int64)
# b = torch.rand(b, n, p).type(torch.int64)
# print()
# print(benchmark_matmul(a, b, torch.bmm))

A = np.array([[[1712932928,  136502746, 1284240508, 1864000860], 
         [ 906285994,  284093373, 2032762391,  767922346], 
         [ 422489901, 2062460604, 2093054437,  578608286], 
         [ 769948479, 1421790395, 2012876046,  331177523]],

        [[ 238732945,  249595271, 1622290342, 2047743859], 
         [1778804022,  817195984, 1953978080, 2036064467], 
         [ 522297888, 1000668095,  866464133, 1645236879], 
         [1341829882, 1882218034,  670224579, 1483670577]]], dtype=np.int32)

B = np.array([[[1712932928,  136502746, 1284240508, 1864000860], 
         [ 906285994,  284093373, 2032762391,  767922346], 
         [ 422489901, 2062460604, 2093054437,  578608286], 
         [ 769948479, 1421790395, 2012876046,  331177523]],

        [[ 238732945,  249595271, 1622290342, 2047743859], 
         [1778804022,  817195984, 1953978080, 2036064467], 
         [ 522297888, 1000668095,  866464133, 1645236879], 
         [1341829882, 1882218034,  670224579, 1483670577]]], dtype=np.int32)

C = np.array([[[1802695732,  929364918, 1774501770, -1262708832], 
         [1986476003, 2051813727, 1683879730, 1900925610], 
         [1092308283, -783694924,  944283181,  201600212], 
         [2113612273, 1834369854, -645056863, 1731321503]],

        [[-1491146583, -1197141129, 1604543741, -2061075675], 
         [-626014844, 2005060304,  923497501,  600623413], 
         [ 577401264, -912688583, -331238426,  678600567], 
         [  90242144, -601656187, -1886784130, 1705960402]]], dtype=np.int32)

print(np.matmul(A,B))
print(np.matmul(A,B) == C)